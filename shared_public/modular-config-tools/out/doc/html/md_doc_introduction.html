<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modular-config-tools: Introduction to modular-config-tools framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modular-config-tools
   </div>
   <div id="projectbrief">Framework for modular (unit testable) config tools</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Introduction to modular-config-tools framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is an introduction to modular-config-tools framework to create modular and unit testable config tools.</p>
<h2>Basic configuration for a modular config tool</h2>
<p>To create a modular config tool you can just add a new target for an executable to the makefile of this project. But you are also free to create your own project as well. As an example how to do that you may take a look to the makefile settings for build target <em>helloworld.elf</em> in this project. The <em>helloworld.elf</em> config tool is the example config tool for this project (see <a href="examples.html" title="Examples">examples page</a>). Its key makefile settings are explained now.</p>
<h3>Build settings</h3>
<p>To use the framework core functionality the primary library <em>libconfigtoolutils</em> are linked statically. In addition the library <em>libconfigtoolfail</em> is linked statically which provides a config tool common implementation for <em>wc_Fail</em>, needed to use the assertion macros from <em>common-header</em> project in header file <em>wc/assertion.h</em>.</p>
<p>To keep the config tool modular and unit testable, its source modules cannot contain a main function. To use a common, predefined main function implementation the <em>helloworld.elf</em> config tool added the common main source module <a href="main_8c.html" title="Common main source module"><em>"src/common/main.c"</em></a> to its source list.</p>
<h3>Entry points for a modular config tool</h3>
<p>By convention the <em>ctparts_ctMain</em> function from <a href="ctmain_8h.html" title="ctmain.h details page"><em>"ctparts/ctmain.h"</em></a> is the entry point for the config tool core functionality. All possible parameter option evaluation and resource acquisition should be already done at this point. Options and resources are shipped in with structures <a href="structctutil__Options.html" title="ctutil_Options_t details page"><em>ctutil_Options_t</em></a> and <a href="structctutil__Resources.html" title="ctutil_Resources_t details page"><em>ctutil_Resources_t</em></a>. Both structures are customizable for config tool specific parameter options and resources.</p>
<p>To prepare the <em>ctparts_ctMain</em> function (e.g. evaluate parameter options and acquire resources) the main function in the common main source module <a href="main_8c.html" title="Common main source module"><em>"src/common/main.c"</em></a> calls the <em>ctparts_PrepareMain</em> function from <a href="pmain_8h.html" title="pmain.h details page"><em>"ctparts/pmain.h"</em></a>. This is by convention the entry point for the config tool functionality to prepare options and resources. This function has to call the specific config tool main function <em>ctparts_ctMain</em>.</p>
<h2>Common main and predefined prototypes</h2>
<p>As a help to implement the <em>ctparts_PrepareMain</em> function from <a href="pmain_8h.html" title="pmain.h details page"><em>"ctparts/pmain.h"</em></a> you may use the <em>ctutil_CommonMain</em> function from <a href="common_main_8h.html" title="common_main.h details page"><em>"ctutil/common_main.h"</em></a>.</p>
<p>This function takes a function table and a user specific context to run a predefined preparation sequence. Common resources acquired by calling the function <em>ctutil_OpenCommonResources</em> and released afterwards by calling the function <em>ctutil_ReleaseCommonResources</em>. Also the <em>ctparts_ctMain</em> function is called in the sequence. The following function pointers may be additionally part of the sequence and the function table (optional functions may be NULL in given function table):</p><ul>
<li><em>ctparts_PrintInfoText_ptr</em> - Prints program information text (optional)</li>
<li><em>ctparts_SetOptionDefaults_ptr</em> - Sets config tool option defaults (mandatory, optionally may also allocate a specific options struct)</li>
<li><em>ctparts_ReleaseSpecificOptions_ptr</em> - Releases config tool specific options (optional, mandatory if specific options struct allocated)</li>
<li><em>ctparts_EvaluateEarlyOptions_ptr</em> - Evaluates options that have to be honored before other options (optional)</li>
<li><em>ctparts_EvaluateOptions_ptr</em> - Evaluates config tool options (optional)</li>
<li><em>ctparts_OpenSpecificResources_ptr</em> - Opens config tool specific resources (optional)</li>
<li><em>ctparts_ReleaseSpecificResources_ptr</em> - Releases config tool specific resources (optional, mandatory if <em>ctparts_OpenSpecificResources_ptr</em> used)</li>
</ul>
<p>To implement preparation functions you may use the prototypes defined in <a href="common_main_8h.html" title="common_main.h details page"><em>"ctutil/common_main.h"</em></a>. To set the function table <em>ctparts_commonMainFunctions_t</em> to the predefined defaults the helper function <em>ctutil_SetDefaultCommonMainFunctions</em> is available.</p>
<h2>Unit tests for a modular config tool</h2>
<p>tbd</p>
<p>Core functionality is tested by calling <em>ctparts_ctMain</em> function.</p>
<p>Preparations may be tested by calling separated functions if necessary. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jul 15 2020 11:41:33 for modular-config-tools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
